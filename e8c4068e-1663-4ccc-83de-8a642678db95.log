"{\"ip_address\":null,\"time\":\"2023-05-06T12:57:17.294Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"save_notebook\",\"cell_source\":\"[\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"# # Do not forget to check if your notebook log collection plugin is working\\nfrom mining_extension import check_logging\\ncheck_logging(\\\\"http://3.249.245.244:9999\\\\")\\",\n    \\"execution_count\\": 49,\n    \\"id\\": \\"6b4e2163ced54131881b1b0e949b6f3b\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"!pip install catboost\\",\n    \\"execution_count\\": 8,\n    \\"id\\": \\"f7123fc1e98e466681c7371ae6dfbbb6\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"import numpy as np\\nimport pandas as pd\\nimport matplotlib.pyplot as plt\\nimport seaborn as sns\\nfrom sklearn.metrics import f1_score\\nfrom sklearn.metrics import mean_squared_error, mean_absolute_error\\nfrom sklearn.preprocessing import StandardScaler, OneHotEncoder\\nfrom sklearn.model_selection import train_test_split, GridSearchCV, RandomizedSearchCV\\nfrom sklearn.feature_selection import RFECV\\nfrom sklearn.pipeline import Pipeline\\nfrom sklearn.ensemble import GradientBoostingRegressor\\nfrom sklearn import datasets\\nfrom xgboost import XGBRegressor, XGBClassifier\\nfrom catboost import CatBoostRegressor, CatBoostClassifier\\",\n    \\"execution_count\\": 85,\n    \\"id\\": \\"346d51ac343a49d68576a76ac7bb8e78\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"import pandas as pd\\nfeatures_path = "data/task2/"\\ntest_features = pd.read_pickle(features_path+"test_features.pkl")\\ntrain_features = pd.read_pickle(features_path+"train_features.pkl")\\nvalidation_features = pd.read_pickle(features_path+"validation_features.pkl")\\n\\ntrain_features.index = range(train_features.shape[0])\\nvalidation_features.index = range(validation_features.shape[0])\\ntest_features.index = range(test_features.shape[0])\\n\\ntrain_features.fillna(0,inplace=True)\\ntest_features.fillna(0,inplace=True)\\nvalidation_features.fillna(0,inplace=True)\\n\\nprint(train_features.shape)\\nprint(validation_features.shape)\\nprint(test_features.shape)\\",\n    \\"execution_count\\": 105,\n    \\"id\\": \\"48b19d2bf70443c0ba1b48d3b532bb5a\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"train_features.text[1]\\",\n    \\"execution_count\\": 13,\n    \\"id\\": \\"8971d9485a2d44a69eef3d90bd097d00\\"\n  },\n  {\n    \\"cell_type\\": \\"markdown\\",\n    \\"source\\": \\"## Data visualization and analys\\",\n    \\"id\\": \\"1531851b9b36469d94d464f942c6b3af\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"# df = pd.concat([train_features, validation_features], axis=0)\\",\n    \\"execution_count\\": 58,\n    \\"id\\": \\"848a369268ba49ad860e7fd8419bc395\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"test_features.T\\",\n    \\"execution_count\\": null,\n    \\"id\\": \\"018b82c206594bb085f89e55da14f5e4\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"train_features.T\\",\n    \\"execution_count\\": 59,\n    \\"id\\": \\"b9a7cad6a4654d5e8a790d60536d8c46\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"primary_label_counts = train_features["primary_label"].value_counts().reset_index()\\n\\nprimary_label_counts["primary_label"] = pd.Categorical(primary_label_counts["primary_label"]).codes\\n\\nprint(primary_label_counts)\\",\n    \\"execution_count\\": 60,\n    \\"id\\": \\"5998f359a6974cfc8ee3f906e557ee7d\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"label_mapping = {\\n    "helper_functions": 0,\\n    "load_data": 1,\\n    "data_exploration": 2,\\n    "data_preprocessing": 3,\\n    "modelling": 4,\\n    "prediction": 5,\\n    "evaluation": 6,\\n    "result_visualization": 7,\\n    "save_results": 8,\\n    "comment_only": 9\\n}\\n\\nvalidation_features["primary_label"] = validation_features["primary_label"].map(label_mapping)\\ntrain_features["primary_label"] = train_features["primary_label"].map(label_mapping)\\",\n    \\"execution_count\\": 96,\n    \\"id\\": \\"f78b1cc575794e728b8ab58ede90de1b\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"def summary(df):\\n    print(f"data shape: {df.shape}")\\n    summ = pd.DataFrame(df.dtypes, columns=["data type"])\\n    summ["#missing"] = df.isnull().sum().values * 100\\n    summ["%missing"] = df.isnull().sum().values / len(df)\\n    summ["#unique"] = df.nunique().values\\n    desc = pd.DataFrame(df.describe(include="all").transpose())\\n    summ["min"] = desc["min"].values\\n    summ["max"] = desc["max"].values\\n    \\n    return summ\\",\n    \\"execution_count\\": 66,\n    \\"id\\": \\"d518dc9ef7984fbe83f67ac9e1f14d63\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"num_columns = list(train_features.select_dtypes(include=["int","float"]).columns)\\ncat_columns = list(train_features.select_dtypes(include=["object","bool","category"]).columns)\\n\\nprint(\\\\"Number of numerical columns:\\\\", len(num_columns))\\nprint(\\\\"Number of categorical columns:\\\\", len(cat_columns))\\nprint(\\\\"Total number of columns in the feature dataframe:\\\\", train_features.shape[1])\\",\n    \\"execution_count\\": 67,\n    \\"id\\": \\"4cf60ac32ec241f080022086798b9391\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"summary(train_features[num_columns])\\",\n    \\"execution_count\\": 68,\n    \\"id\\": \\"f5e5c51af94b47f0810e68ef67c6f26e\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"train_features.describe().T\\",\n    \\"execution_count\\": 69,\n    \\"id\\": \\"67ef05379a60443b8bb72ba7286c140a\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"plt.figure(figsize=(15,10))\\nfor id,column in enumerate(num_columns[:-1]):\\n    plt.subplot(6,4,id+1)\\n    sns.histplot(x=column,data=train_features, kde=True, palette=\\\\"Set1\\\\")\\n    plt.title(f\\\\"{column} Distribution\\\\")\\n    plt.tight_layout()\\",\n    \\"execution_count\\": 70,\n    \\"id\\": \\"c1dd94f5951d480b82e63b70582ec83f\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"fig = plt.figure(figsize=(6*6, 20))\\nfor idx, col in enumerate(num_columns):\\n    ax = plt.subplot(5, 5, idx + 1)\\n    sns.kdeplot(\\n        data=train_features, fill=True,\\n        x=col, palette=["#9E3F00", "red"], legend=False\\n    )\\n            \\n    ax.set_ylabel(""); ax.spines["top"].set_visible(False), \\n    ax.set_xlabel(""); ax.spines["right"].set_visible(False)\\n    ax.set_title(f"{col}", loc="right", \\n                 weight="bold", fontsize=20)\\n\\nfig.suptitle(f"Features vs Target\\\\n\\\\n\\\\n", ha="center",  fontweight="bold", fontsize=25)\\nfig.legend([1, 0], loc="upper center", bbox_to_anchor=(0.5, 0.96), fontsize=25, ncol=3)\\nplt.tight_layout()\\nplt.show()\\",\n    \\"execution_count\\": 71,\n    \\"id\\": \\"6b37b947b35549cc8013456b2d2de100\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"features = train_features[["cell_number", "execution_count", "linesofcode", "variable_count",\\n                           "function_count", "text/plain", "image/png", "text/html",\\n                           "display_data", "stream", "error"]]\\n\\ncorr_matrix = features.corr()\\n\\nplt.figure(figsize=(10, 8))\\nsns.heatmap(corr_matrix, annot=True, cmap="coolwarm", square=True)\\n\\nplt.title(\\\\"Correlation Heatmap\\\\")\\nplt.show()\\",\n    \\"execution_count\\": 106,\n    \\"id\\": \\"31ba522c0583431e8eb05aeffc148c00\\"\n  },\n  {\n    \\"cell_type\\": \\"markdown\\",\n    \\"source\\": \\"## Data preprocessing\\",\n    \\"id\\": \\"d6cc9c149fd54b2d9abc21e476e950e9\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"scaler = StandardScaler()\\",\n    \\"execution_count\\": 72,\n    \\"id\\": \\"99fa106569bd4599be58f855cf738c6b\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"train_features[["cell_number", "execution_count", "linesofcode", "variable_count",\\n       "function_count", "text/plain", "image/png", "text/html",\\n       "display_data", "stream", "error"]] = scaler.fit_transform(train_features[["cell_number", "execution_count", "linesofcode", "variable_count",\\n       "function_count", "text/plain", "image/png", "text/html",\\n       "display_data", "stream", "error"]])\\n\\nvalidation_features[["cell_number", "execution_count", "linesofcode", "variable_count",\\n       "function_count", "text/plain", "image/png", "text/html",\\n       "display_data", "stream", "error"]] = scaler.fit_transform(validation_features[["cell_number", "execution_count", "linesofcode", "variable_count",\\n       "function_count", "text/plain", "image/png", "text/html",\\n       "display_data", "stream", "error"]])\\n\\ntest_features[["cell_number", "execution_count", "linesofcode", "variable_count",\\n       "function_count", "text/plain", "image/png", "text/html",\\n       "display_data", "stream", "error"]] = scaler.fit_transform(test_features[["cell_number", "execution_count", "linesofcode", "variable_count",\\n       "function_count", "text/plain", "image/png", "text/html",\\n       "display_data", "stream", "error"]])\\",\n    \\"execution_count\\": 100,\n    \\"id\\": \\"cb1d8a37a2cd4bda8c1b310e3ff674ed\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"\\",\n    \\"execution_count\\": null,\n    \\"id\\": \\"a7cb2f1b309747829a4f9ef0d63c150c\\"\n  },\n  {\n    \\"cell_type\\": \\"markdown\\",\n    \\"source\\": \\"## Features choosing and fit-predict\\",\n    \\"id\\": \\"321bada4a76e4d2f852a6cc238f49846\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"X = train_features[["cell_number", "execution_count", "linesofcode", "variable_count",\\n       "function_count", "text/plain", "image/png", "text/html",\\n       "display_data", "stream", "error"]]\\n\\ny = train_features["primary_label"]\\n\\nrfe = RFECV(estimator = XGBClassifier(max_depth = 7, \\n                           n_estimators = 500, learning_rate = 0.01), min_features_to_select = 2, cv = 5).fit(X, y)\\n\\nprint(X.columns[rfe.support_])\\",\n    \\"execution_count\\": 74,\n    \\"id\\": \\"2b50929087c94e408a731763eeb8ea9b\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"X = train_features[["cell_number", "execution_count", "linesofcode", "variable_count",\\n       "function_count", "text/plain", "image/png", "text/html",\\n       "display_data", "stream", "error"]]\\ny = train_features["primary_label"]\\n\\nX_val = validation_features[["cell_number", "execution_count", "linesofcode", "variable_count",\\n       "function_count", "text/plain", "image/png", "text/html",\\n       "display_data", "stream", "error"]]\\ny_val = validation_features["primary_label"]\\n\\ntest = test_features[["cell_number", "execution_count", "linesofcode", "variable_count",\\n       "function_count", "text/plain", "image/png", "text/html",\\n       "display_data", "stream", "error"]]\\n# y = np.log(y)\\",\n    \\"execution_count\\": 82,\n    \\"id\\": \\"2016d4f03a514964859ec4f9518194fa\\"\n  },\n  {\n    \\"cell_type\\": \\"markdown\\",\n    \\"source\\": \\"### CatBoostClassifier\\",\n    \\"id\\": \\"79a88fda134c4b168246f070a9e05071\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"cat_model = CatBoostClassifier()\\n\\ncat_parameters = {"learning_rate": [0.03, 0.1],\\n                  "iterations": [50, 100, 300, 500, 1000],\\n                  "depth": [4, 6, 10], \\n                  "l2_leaf_reg": [0.5, 1, 3, 5, 7, 9],\\n}\\n\\ncat_grid = RandomizedSearchCV(estimator=cat_model, \\n                             param_distributions = cat_parameters,\\n                             cv = 5, \\n                             n_jobs=5,)\\n\\ncat_grid.fit(X, y, silent=True)\\",\n    \\"execution_count\\": 76,\n    \\"id\\": \\"540c9f35f8ff4efaa732f83a99a3dbb3\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"cat_parameters_best = cat_grid.best_params_\\nprint(cat_grid.best_params_)\\",\n    \\"execution_count\\": 77,\n    \\"id\\": \\"08fae4f4de7f4e7dbd66ad8bc8b30c23\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"cat_model_best = CatBoostRegressor(**cat_grid.best_params_)\\n\\ncat_model_best.fit(X, y, silent=True)\\n\\npred_cat = cat_model_best.predict(test)\\",\n    \\"execution_count\\": 78,\n    \\"id\\": \\"6715f24e0d1949e4851b67c9849e1b33\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"val_cat = cat_model_best.predict(X_val).round()\\n\\nf1_score(list(y_val), list(val_cat), average="weighted")\\",\n    \\"execution_count\\": null,\n    \\"id\\": \\"87181d7af56c4ff4838d3af144286427\\"\n  },\n  {\n    \\"cell_type\\": \\"markdown\\",\n    \\"source\\": \\"### XGBClassifier\\",\n    \\"id\\": \\"64f411dd5d4c4bfb8283af0912d667e5\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"xgb_model = XGBClassifier()\\n\\nxgb_parameters = {"nthread":[4],\\n                  "learning_rate": [0.05, 0.1],\\n                  "max_depth": [4, 6, 8],\\n                  "min_child_weight": [5, 11, 20],\\n                  "n_estimators": [50, 100, 300, 500, 1000],\\n                  "min_samples_leaf": [1, 2, 4],\\n                  "min_samples_split": [2, 5, 10],\\n}\\n\\n\\nxgb_grid = RandomizedSearchCV(estimator=xgb_model, \\n                             param_distributions = xgb_parameters,\\n                             cv = 5, \\n                             n_jobs=5)\\n\\nxgb_grid.fit(X, y)\\",\n    \\"execution_count\\": 79,\n    \\"id\\": \\"8a8b1e288fd141b69e6a9e56555c590a\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"xgb_parameters_best = xgb_grid.best_params_\\nprint(xgb_grid.best_params_)\\",\n    \\"execution_count\\": 80,\n    \\"id\\": \\"b5daf6743e5345dc815862f98e4c8b67\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"xgb_model_best = XGBRegressor(**xgb_parameters_best)\\n\\nxgb_model_best.fit(X, y)\\n\\npred_xgb = xgb_model_best.predict(test)\\",\n    \\"execution_count\\": 81,\n    \\"id\\": \\"5e50fb1b58794a7a930178425f8205c6\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"val_xgb = xgb_model_best.predict(X_val).round()\\n\\nf1_score(list(y_val), list(val_xgb), average="weighted")\\",\n    \\"execution_count\\": null,\n    \\"id\\": \\"372efb0afae549989f37a124c745f321\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"\\",\n    \\"execution_count\\": null,\n    \\"id\\": \\"2f6cd9bbaaaf459a8791769ea69b643d\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"\\",\n    \\"execution_count\\": null,\n    \\"id\\": \\"fe5cc27f17e14287abc069969efd9574\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"print("test plugin connection")\\",\n    \\"execution_count\\": 108,\n    \\"id\\": \\"3ae555bacbba4da78ce4ebffbd956e20\\"\n  },\n  {\n    \\"cell_type\\": \\"code\\",\n    \\"source\\": \\"\\",\n    \\"execution_count\\": null,\n    \\"id\\": \\"b490cf95057949fe975f747972fe05a6\\"\n  }\n]\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:22.038Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"6b4e2163ced54131881b1b0e949b6f3b\",\"cell_num\":0,\"cell_source\":\"# # Do not forget to check if your notebook log collection plugin is working\nfrom mining_extension import check_logging\ncheck_logging(\\"http://3.249.245.244:9999\\")\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:22.300Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"6b4e2163ced54131881b1b0e949b6f3b\",\"cell_num\":1,\"cell_source\":\"# # Do not forget to check if your notebook log collection plugin is working\nfrom mining_extension import check_logging\ncheck_logging(\\"http://3.249.245.244:9999\\")\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"stream\\",\\"size\\":23}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:23.036Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"f7123fc1e98e466681c7371ae6dfbbb6\",\"cell_num\":1,\"cell_source\":\"!pip install catboost\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:25.479Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"346d51ac343a49d68576a76ac7bb8e78\",\"cell_num\":2,\"cell_source\":\"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.metrics import f1_score\nfrom sklearn.metrics import mean_squared_error, mean_absolute_error\nfrom sklearn.preprocessing import StandardScaler, OneHotEncoder\nfrom sklearn.model_selection import train_test_split, GridSearchCV, RandomizedSearchCV\nfrom sklearn.feature_selection import RFECV\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.ensemble import GradientBoostingRegressor\nfrom sklearn import datasets\nfrom xgboost import XGBRegressor, XGBClassifier\nfrom catboost import CatBoostRegressor, CatBoostClassifier\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:28.101Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"f7123fc1e98e466681c7371ae6dfbbb6\",\"cell_num\":3,\"cell_source\":\"!pip install catboost\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"stream\\",\\"size\\":2154}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:31.089Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"48b19d2bf70443c0ba1b48d3b532bb5a\",\"cell_num\":3,\"cell_source\":\"import pandas as pd\nfeatures_path = "data/task2/"\ntest_features = pd.read_pickle(features_path+"test_features.pkl")\ntrain_features = pd.read_pickle(features_path+"train_features.pkl")\nvalidation_features = pd.read_pickle(features_path+"validation_features.pkl")\n\ntrain_features.index = range(train_features.shape[0])\nvalidation_features.index = range(validation_features.shape[0])\ntest_features.index = range(test_features.shape[0])\n\ntrain_features.fillna(0,inplace=True)\ntest_features.fillna(0,inplace=True)\nvalidation_features.fillna(0,inplace=True)\n\nprint(train_features.shape)\nprint(validation_features.shape)\nprint(test_features.shape)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:32.326Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"8971d9485a2d44a69eef3d90bd097d00\",\"cell_num\":4,\"cell_source\":\"train_features.text[1]\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:32.449Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"346d51ac343a49d68576a76ac7bb8e78\",\"cell_num\":5,\"cell_source\":\"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.metrics import f1_score\nfrom sklearn.metrics import mean_squared_error, mean_absolute_error\nfrom sklearn.preprocessing import StandardScaler, OneHotEncoder\nfrom sklearn.model_selection import train_test_split, GridSearchCV, RandomizedSearchCV\nfrom sklearn.feature_selection import RFECV\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.ensemble import GradientBoostingRegressor\nfrom sklearn import datasets\nfrom xgboost import XGBRegressor, XGBClassifier\nfrom catboost import CatBoostRegressor, CatBoostClassifier\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:32.974Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"48b19d2bf70443c0ba1b48d3b532bb5a\",\"cell_num\":5,\"cell_source\":\"import pandas as pd\nfeatures_path = "data/task2/"\ntest_features = pd.read_pickle(features_path+"test_features.pkl")\ntrain_features = pd.read_pickle(features_path+"train_features.pkl")\nvalidation_features = pd.read_pickle(features_path+"validation_features.pkl")\n\ntrain_features.index = range(train_features.shape[0])\nvalidation_features.index = range(validation_features.shape[0])\ntest_features.index = range(test_features.shape[0])\n\ntrain_features.fillna(0,inplace=True)\ntest_features.fillna(0,inplace=True)\nvalidation_features.fillna(0,inplace=True)\n\nprint(train_features.shape)\nprint(validation_features.shape)\nprint(test_features.shape)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"stream\\",\\"size\\":38}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:33.211Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"8971d9485a2d44a69eef3d90bd097d00\",\"cell_num\":6,\"cell_source\":\"train_features.text[1]\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"execute_result\\",\\"size\\":316}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:34.121Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"848a369268ba49ad860e7fd8419bc395\",\"cell_num\":6,\"cell_source\":\"# df = pd.concat([train_features, validation_features], axis=0)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:34.203Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"848a369268ba49ad860e7fd8419bc395\",\"cell_num\":7,\"cell_source\":\"# df = pd.concat([train_features, validation_features], axis=0)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:35.365Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"018b82c206594bb085f89e55da14f5e4\",\"cell_num\":7,\"cell_source\":\"test_features.T\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:35.603Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"018b82c206594bb085f89e55da14f5e4\",\"cell_num\":8,\"cell_source\":\"test_features.T\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"execute_result\\",\\"size\\":45025}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:36.286Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"b9a7cad6a4654d5e8a790d60536d8c46\",\"cell_num\":8,\"cell_source\":\"train_features.T\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:36.577Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"b9a7cad6a4654d5e8a790d60536d8c46\",\"cell_num\":9,\"cell_source\":\"train_features.T\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"execute_result\\",\\"size\\":60166}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:37.217Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"5998f359a6974cfc8ee3f906e557ee7d\",\"cell_num\":9,\"cell_source\":\"primary_label_counts = train_features["primary_label"].value_counts().reset_index()\n\nprimary_label_counts["primary_label"] = pd.Categorical(primary_label_counts["primary_label"]).codes\n\nprint(primary_label_counts)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:37.298Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"5998f359a6974cfc8ee3f906e557ee7d\",\"cell_num\":10,\"cell_source\":\"primary_label_counts = train_features["primary_label"].value_counts().reset_index()\n\nprimary_label_counts["primary_label"] = pd.Categorical(primary_label_counts["primary_label"]).codes\n\nprint(primary_label_counts)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"stream\\",\\"size\\":442}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:38.433Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"f78b1cc575794e728b8ab58ede90de1b\",\"cell_num\":10,\"cell_source\":\"label_mapping = {\n    "helper_functions": 0,\n    "load_data": 1,\n    "data_exploration": 2,\n    "data_preprocessing": 3,\n    "modelling": 4,\n    "prediction": 5,\n    "evaluation": 6,\n    "result_visualization": 7,\n    "save_results": 8,\n    "comment_only": 9\n}\n\nvalidation_features["primary_label"] = validation_features["primary_label"].map(label_mapping)\ntrain_features["primary_label"] = train_features["primary_label"].map(label_mapping)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:57:38.494Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"f78b1cc575794e728b8ab58ede90de1b\",\"cell_num\":11,\"cell_source\":\"label_mapping = {\n    "helper_functions": 0,\n    "load_data": 1,\n    "data_exploration": 2,\n    "data_preprocessing": 3,\n    "modelling": 4,\n    "prediction": 5,\n    "evaluation": 6,\n    "result_visualization": 7,\n    "save_results": 8,\n    "comment_only": 9\n}\n\nvalidation_features["primary_label"] = validation_features["primary_label"].map(label_mapping)\ntrain_features["primary_label"] = train_features["primary_label"].map(label_mapping)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:58:24.996Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"d518dc9ef7984fbe83f67ac9e1f14d63\",\"cell_num\":11,\"cell_source\":\"def summary(df):\n    print(f"data shape: {df.shape}")\n    summ = pd.DataFrame(df.dtypes, columns=["data type"])\n    summ["#missing"] = df.isnull().sum().values * 100\n    summ["%missing"] = df.isnull().sum().values / len(df)\n    summ["#unique"] = df.nunique().values\n    desc = pd.DataFrame(df.describe(include="all").transpose())\n    summ["min"] = desc["min"].values\n    summ["max"] = desc["max"].values\n    \n    return summ\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:58:25.056Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"d518dc9ef7984fbe83f67ac9e1f14d63\",\"cell_num\":12,\"cell_source\":\"def summary(df):\n    print(f"data shape: {df.shape}")\n    summ = pd.DataFrame(df.dtypes, columns=["data type"])\n    summ["#missing"] = df.isnull().sum().values * 100\n    summ["%missing"] = df.isnull().sum().values / len(df)\n    summ["#unique"] = df.nunique().values\n    desc = pd.DataFrame(df.describe(include="all").transpose())\n    summ["min"] = desc["min"].values\n    summ["max"] = desc["max"].values\n    \n    return summ\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:58:25.369Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"4cf60ac32ec241f080022086798b9391\",\"cell_num\":12,\"cell_source\":\"num_columns = list(train_features.select_dtypes(include=["int","float"]).columns)\ncat_columns = list(train_features.select_dtypes(include=["object","bool","category"]).columns)\n\nprint(\\"Number of numerical columns:\\", len(num_columns))\nprint(\\"Number of categorical columns:\\", len(cat_columns))\nprint(\\"Total number of columns in the feature dataframe:\\", train_features.shape[1])\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:58:25.429Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"4cf60ac32ec241f080022086798b9391\",\"cell_num\":13,\"cell_source\":\"num_columns = list(train_features.select_dtypes(include=["int","float"]).columns)\ncat_columns = list(train_features.select_dtypes(include=["object","bool","category"]).columns)\n\nprint(\\"Number of numerical columns:\\", len(num_columns))\nprint(\\"Number of categorical columns:\\", len(cat_columns))\nprint(\\"Total number of columns in the feature dataframe:\\", train_features.shape[1])\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"stream\\",\\"size\\":123}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:58:26.162Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"f5e5c51af94b47f0810e68ef67c6f26e\",\"cell_num\":13,\"cell_source\":\"summary(train_features[num_columns])\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:58:26.386Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"f5e5c51af94b47f0810e68ef67c6f26e\",\"cell_num\":14,\"cell_source\":\"summary(train_features[num_columns])\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"stream\\",\\"size\\":26},{\\"output_type\\":\\"execute_result\\",\\"size\\":6514}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:58:26.975Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"67ef05379a60443b8bb72ba7286c140a\",\"cell_num\":14,\"cell_source\":\"train_features.describe().T\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:58:27.167Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"67ef05379a60443b8bb72ba7286c140a\",\"cell_num\":15,\"cell_source\":\"train_features.describe().T\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"execute_result\\",\\"size\\":8751}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:58:27.874Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"c1dd94f5951d480b82e63b70582ec83f\",\"cell_num\":15,\"cell_source\":\"plt.figure(figsize=(15,10))\nfor id,column in enumerate(num_columns[:-1]):\n    plt.subplot(6,4,id+1)\n    sns.histplot(x=column,data=train_features, kde=True, palette=\\"Set1\\")\n    plt.title(f\\"{column} Distribution\\")\n    plt.tight_layout()\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:58:29.051Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"6b37b947b35549cc8013456b2d2de100\",\"cell_num\":16,\"cell_source\":\"fig = plt.figure(figsize=(6*6, 20))\nfor idx, col in enumerate(num_columns):\n    ax = plt.subplot(5, 5, idx + 1)\n    sns.kdeplot(\n        data=train_features, fill=True,\n        x=col, palette=["#9E3F00", "red"], legend=False\n    )\n            \n    ax.set_ylabel(""); ax.spines["top"].set_visible(False), \n    ax.set_xlabel(""); ax.spines["right"].set_visible(False)\n    ax.set_title(f"{col}", loc="right", \n                 weight="bold", fontsize=20)\n\nfig.suptitle(f"Features vs Target\\n\\n\\n", ha="center",  fontweight="bold", fontsize=25)\nfig.legend([1, 0], loc="upper center", bbox_to_anchor=(0.5, 0.96), fontsize=25, ncol=3)\nplt.tight_layout()\nplt.show()\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T12:58:30.297Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"31ba522c0583431e8eb05aeffc148c00\",\"cell_num\":17,\"cell_source\":\"features = train_features[["cell_number", "execution_count", "linesofcode", "variable_count",\n                           "function_count", "text/plain", "image/png", "text/html",\n                           "display_data", "stream", "error"]]\n\ncorr_matrix = features.corr()\n\nplt.figure(figsize=(10, 8))\nsns.heatmap(corr_matrix, annot=True, cmap="coolwarm", square=True)\n\nplt.title(\\"Correlation Heatmap\\")\nplt.show()\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T13:01:50.518Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"c1dd94f5951d480b82e63b70582ec83f\",\"cell_num\":23,\"cell_source\":\"plt.figure(figsize=(15,10))\nfor id,column in enumerate(num_columns[:-1]):\n    plt.subplot(6,4,id+1)\n    sns.histplot(x=column,data=train_features, kde=True, palette=\\"Set1\\")\n    plt.title(f\\"{column} Distribution\\")\n    plt.tight_layout()\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"display_data\\",\\"size\\":115297}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T13:01:55.236Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"6b37b947b35549cc8013456b2d2de100\",\"cell_num\":23,\"cell_source\":\"fig = plt.figure(figsize=(6*6, 20))\nfor idx, col in enumerate(num_columns):\n    ax = plt.subplot(5, 5, idx + 1)\n    sns.kdeplot(\n        data=train_features, fill=True,\n        x=col, palette=["#9E3F00", "red"], legend=False\n    )\n            \n    ax.set_ylabel(""); ax.spines["top"].set_visible(False), \n    ax.set_xlabel(""); ax.spines["right"].set_visible(False)\n    ax.set_title(f"{col}", loc="right", \n                 weight="bold", fontsize=20)\n\nfig.suptitle(f"Features vs Target\\n\\n\\n", ha="center",  fontweight="bold", fontsize=25)\nfig.legend([1, 0], loc="upper center", bbox_to_anchor=(0.5, 0.96), fontsize=25, ncol=3)\nplt.tight_layout()\nplt.show()\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"display_data\\",\\"size\\":294710}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T13:01:56.239Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"31ba522c0583431e8eb05aeffc148c00\",\"cell_num\":23,\"cell_source\":\"features = train_features[["cell_number", "execution_count", "linesofcode", "variable_count",\n                           "function_count", "text/plain", "image/png", "text/html",\n                           "display_data", "stream", "error"]]\n\ncorr_matrix = features.corr()\n\nplt.figure(figsize=(10, 8))\nsns.heatmap(corr_matrix, annot=True, cmap="coolwarm", square=True)\n\nplt.title(\\"Correlation Heatmap\\")\nplt.show()\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"display_data\\",\\"size\\":99739}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:33:52.611Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"346d51ac343a49d68576a76ac7bb8e78\",\"cell_num\":2,\"cell_source\":\"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.metrics import f1_score\nfrom sklearn.metrics import mean_squared_error, mean_absolute_error\nfrom sklearn.preprocessing import StandardScaler, OneHotEncoder\nfrom sklearn.model_selection import train_test_split, GridSearchCV, RandomizedSearchCV\nfrom sklearn.feature_selection import RFECV\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.ensemble import GradientBoostingRegressor\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.datasets import make_classification\nfrom sklearn import datasets\nfrom xgboost import XGBRegressor, XGBClassifier\nfrom catboost import CatBoostRegressor, CatBoostClassifier\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:33:52.822Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"346d51ac343a49d68576a76ac7bb8e78\",\"cell_num\":3,\"cell_source\":\"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.metrics import f1_score\nfrom sklearn.metrics import mean_squared_error, mean_absolute_error\nfrom sklearn.preprocessing import StandardScaler, OneHotEncoder\nfrom sklearn.model_selection import train_test_split, GridSearchCV, RandomizedSearchCV\nfrom sklearn.feature_selection import RFECV\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.ensemble import GradientBoostingRegressor\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.datasets import make_classification\nfrom sklearn import datasets\nfrom xgboost import XGBRegressor, XGBClassifier\nfrom catboost import CatBoostRegressor, CatBoostClassifier\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:34:31.165Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"rendered\",\"cell_index\":\"e8073f95559940138b0643bf7afa2f2a\",\"cell_num\":35,\"cell_source\":\"\",\"cell_type\":\"markdown\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:34:31.169Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"create\",\"cell_index\":\"e8073f95559940138b0643bf7afa2f2a\",\"cell_num\":35,\"cell_source\":\"\",\"cell_type\":\"markdown\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:34:40.427Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"rendered\",\"cell_index\":\"e8073f95559940138b0643bf7afa2f2a\",\"cell_num\":35,\"cell_source\":\"## Random Forest\",\"cell_type\":\"markdown\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:36:36.863Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"fe5cc27f17e14287abc069969efd9574\",\"cell_num\":37,\"cell_source\":\"clf = RandomForestClassifier(max_depth=7, min_samples_leaf=5, min_samples_split=5, n_estimators=600)\nclf.fit(X, y)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"error\\",\\"size\\":0}]\"}"[EVENT_SEPARATOR]
"{\"time\":\"2023-05-06T14:36:36.863Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"error\",\"cell_index\":\"fe5cc27f17e14287abc069969efd9574\",\"cell_num\":37,\"cell_source\":\"{\\"output_type\\":\\"error\\",\\"ename\\":\\"NameError\\",\\"evalue\\":\\"name "X" is not defined\\"}\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:36:42.096Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"2016d4f03a514964859ec4f9518194fa\",\"cell_num\":24,\"cell_source\":\"X = train_features[["cell_number", "execution_count", "linesofcode", "variable_count",\n       "function_count", "text/plain", "image/png", "text/html",\n       "display_data", "stream", "error"]]\ny = train_features["primary_label"]\n\nX_val = validation_features[["cell_number", "execution_count", "linesofcode", "variable_count",\n       "function_count", "text/plain", "image/png", "text/html",\n       "display_data", "stream", "error"]]\ny_val = validation_features["primary_label"]\n\ntest = test_features[["cell_number", "execution_count", "linesofcode", "variable_count",\n       "function_count", "text/plain", "image/png", "text/html",\n       "display_data", "stream", "error"]]\n# y = np.log(y)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:36:42.184Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"2016d4f03a514964859ec4f9518194fa\",\"cell_num\":25,\"cell_source\":\"X = train_features[["cell_number", "execution_count", "linesofcode", "variable_count",\n       "function_count", "text/plain", "image/png", "text/html",\n       "display_data", "stream", "error"]]\ny = train_features["primary_label"]\n\nX_val = validation_features[["cell_number", "execution_count", "linesofcode", "variable_count",\n       "function_count", "text/plain", "image/png", "text/html",\n       "display_data", "stream", "error"]]\ny_val = validation_features["primary_label"]\n\ntest = test_features[["cell_number", "execution_count", "linesofcode", "variable_count",\n       "function_count", "text/plain", "image/png", "text/html",\n       "display_data", "stream", "error"]]\n# y = np.log(y)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:36:44.716Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"fe5cc27f17e14287abc069969efd9574\",\"cell_num\":36,\"cell_source\":\"clf = RandomForestClassifier(max_depth=7, min_samples_leaf=5, min_samples_split=5, n_estimators=600)\nclf.fit(X, y)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:36:47.301Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"fe5cc27f17e14287abc069969efd9574\",\"cell_num\":37,\"cell_source\":\"clf = RandomForestClassifier(max_depth=7, min_samples_leaf=5, min_samples_split=5, n_estimators=600)\nclf.fit(X, y)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"execute_result\\",\\"size\\":135}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:36:49.272Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"create\",\"cell_index\":\"c4db94ce369741b084baea3d7d98905b\",\"cell_num\":36,\"cell_source\":\"\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:36:49.784Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"create\",\"cell_index\":\"7e6e83b7466749569eee2e09d08376dd\",\"cell_num\":37,\"cell_source\":\"\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:37:12.637Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"c4db94ce369741b084baea3d7d98905b\",\"cell_num\":37,\"cell_source\":\"val_rf = clf.predict(X_val).round()\n\nf1_score(list(y_val), list(val_rf), average="weighted")\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:37:12.993Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"c4db94ce369741b084baea3d7d98905b\",\"cell_num\":38,\"cell_source\":\"val_rf = clf.predict(X_val).round()\n\nf1_score(list(y_val), list(val_rf), average="weighted")\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"execute_result\\",\\"size\\":35}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:38:23.866Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"rendered\",\"cell_index\":\"e8073f95559940138b0643bf7afa2f2a\",\"cell_num\":35,\"cell_source\":\"## Random Forest\",\"cell_type\":\"markdown\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:38:25.003Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"create\",\"cell_index\":\"98c4a8b954274dcb9ef0ce9f6830aa27\",\"cell_num\":35,\"cell_source\":\"\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:41:13.432Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"98c4a8b954274dcb9ef0ce9f6830aa27\",\"cell_num\":36,\"cell_source\":\"param_grid = { \n    "n_estimators": [200, 500, 800, 1000, 1200],\n    "max_features": ["auto", "sqrt", "log2"],\n    "max_depth" : [4, 7, 8, 10, 15, 30],\n    "criterion" :["gini", "entropy"],\n    "bootstrap": [True, False],\n    "min_samples_leaf": [1, 2, 4],\n    "min_samples_split": [2, 5, 10],\n}\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:41:13.534Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"98c4a8b954274dcb9ef0ce9f6830aa27\",\"cell_num\":37,\"cell_source\":\"param_grid = { \n    "n_estimators": [200, 500, 800, 1000, 1200],\n    "max_features": ["auto", "sqrt", "log2"],\n    "max_depth" : [4, 7, 8, 10, 15, 30],\n    "criterion" :["gini", "entropy"],\n    "bootstrap": [True, False],\n    "min_samples_leaf": [1, 2, 4],\n    "min_samples_split": [2, 5, 10],\n}\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:41:22.121Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"fe5cc27f17e14287abc069969efd9574\",\"cell_num\":38,\"cell_source\":\"rf = RandomForestRegressor()\n\nrf_random = RandomizedSearchCV(estimator = rf, param_distributions = random_grid, n_iter = 100, cv = 3, verbose=2, random_state=42, n_jobs = -1)# Fit the random search model\nrf_random.fit(X, y)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"error\\",\\"size\\":0}]\"}"[EVENT_SEPARATOR]
"{\"time\":\"2023-05-06T14:41:22.121Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"error\",\"cell_index\":\"fe5cc27f17e14287abc069969efd9574\",\"cell_num\":38,\"cell_source\":\"{\\"output_type\\":\\"error\\",\\"ename\\":\\"NameError\\",\\"evalue\\":\\"name "RandomForestRegressor" is not defined\\"}\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:41:36.423Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"fe5cc27f17e14287abc069969efd9574\",\"cell_num\":38,\"cell_source\":\"rf = RandomForestClassifier()\n\nrf_random = RandomizedSearchCV(estimator = rf, param_distributions = random_grid, n_iter = 100, cv = 3, verbose=2, random_state=42, n_jobs = -1)# Fit the random search model\nrf_random.fit(X, y)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"error\\",\\"size\\":0}]\"}"[EVENT_SEPARATOR]
"{\"time\":\"2023-05-06T14:41:36.423Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"error\",\"cell_index\":\"fe5cc27f17e14287abc069969efd9574\",\"cell_num\":38,\"cell_source\":\"{\\"output_type\\":\\"error\\",\\"ename\\":\\"NameError\\",\\"evalue\\":\\"name "random_grid" is not defined\\"}\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:41:59.094Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"fe5cc27f17e14287abc069969efd9574\",\"cell_num\":37,\"cell_source\":\"rf = RandomForestClassifier()\n\nrf_random = RandomizedSearchCV(estimator = rf, param_distributions = param_grid, n_iter = 100, cv = 3, verbose=2, random_state=42, n_jobs = -1)\nrf_random.fit(X, y)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:52:17.992Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"fe5cc27f17e14287abc069969efd9574\",\"cell_num\":37,\"cell_source\":\"rf = RandomForestClassifier()\n\nrf_random = RandomizedSearchCV(estimator = rf, param_distributions = param_grid, n_iter = 100, cv = 3, verbose=2, random_state=42, n_jobs = -1)\nrf_random.fit(X, y)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"stream\\",\\"size\\":8284},{\\"output_type\\":\\"stream\\",\\"size\\":16447},{\\"output_type\\":\\"stream\\",\\"size\\":8217},{\\"output_type\\":\\"execute_result\\",\\"size\\":821}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:55:44.986Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"c4db94ce369741b084baea3d7d98905b\",\"cell_num\":38,\"cell_source\":\"val_rf = rf_random.predict(X_val).round()\n\nf1_score(list(y_val), list(val_rf), average="weighted")\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:55:45.548Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"c4db94ce369741b084baea3d7d98905b\",\"cell_num\":39,\"cell_source\":\"val_rf = rf_random.predict(X_val).round()\n\nf1_score(list(y_val), list(val_rf), average="weighted")\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"execute_result\\",\\"size\\":35}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:56:18.872Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"delete\",\"cell_index\":\"3ae555bacbba4da78ce4ebffbd956e20\",\"cell_num\":null,\"cell_source\":\"print("test plugin connection")\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:57:53.327Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"7e6e83b7466749569eee2e09d08376dd\",\"cell_num\":39,\"cell_source\":\"val_rf\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:57:53.387Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"7e6e83b7466749569eee2e09d08376dd\",\"cell_num\":40,\"cell_source\":\"val_rf\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"execute_result\\",\\"size\\":47}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T14:58:06.706Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"kernel_interrupting\",\"cell_index\":\"\",\"cell_num\":39,\"cell_source\":\"\",\"cell_type\":\"\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:06:42.032Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"create\",\"cell_index\":\"a26e8712c25b42bf99bfb072c4e88301\",\"cell_num\":39,\"cell_source\":\"\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:06:42.568Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"create\",\"cell_index\":\"63f1fcead3e343c89d09617ba98e31f9\",\"cell_num\":40,\"cell_source\":\"\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:06:42.860Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"create\",\"cell_index\":\"ed60342c50894c5985cf6d366e124a83\",\"cell_num\":41,\"cell_source\":\"\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:06:43.003Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"create\",\"cell_index\":\"65f1ee98854847f2a9c6728bcf53ee6d\",\"cell_num\":42,\"cell_source\":\"\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:06:52.241Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"63f1fcead3e343c89d09617ba98e31f9\",\"cell_num\":41,\"cell_source\":\"new_test_features = ["helper_functions", "load_data", "data_exploration", "data_preprocessing", \n    "evaluation", "modelling", "prediction", "result_visualization", "save_results", "comment_only"]\n\nfor i in new_test_features:\n    y_new = train_features[i]\n    rf = RandomForestClassifier()\n    rf.fit(X, y_new)\n    test_features[i] = rf.predict(test)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:06:57.451Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"63f1fcead3e343c89d09617ba98e31f9\",\"cell_num\":42,\"cell_source\":\"new_test_features = ["helper_functions", "load_data", "data_exploration", "data_preprocessing", \n    "evaluation", "modelling", "prediction", "result_visualization", "save_results", "comment_only"]\n\nfor i in new_test_features:\n    y_new = train_features[i]\n    rf = RandomForestClassifier()\n    rf.fit(X, y_new)\n    test_features[i] = rf.predict(test)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:07:06.008Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"ed60342c50894c5985cf6d366e124a83\",\"cell_num\":42,\"cell_source\":\"test_features\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:07:06.188Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"ed60342c50894c5985cf6d366e124a83\",\"cell_num\":43,\"cell_source\":\"test_features\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"execute_result\\",\\"size\\":10081}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:08:13.321Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"63f1fcead3e343c89d09617ba98e31f9\",\"cell_num\":41,\"cell_source\":\"new_test_features = ["helper_functions", "load_data", "data_exploration", "data_preprocessing", \n    "evaluation", "modelling", "prediction", "result_visualization", "save_results", "comment_only"]\n\nfor i in new_test_features:\n    y_new = train_features[i]\n    rf = RandomForestClassifier()\n    rf.fit(X, y_new)\n    val_rf = rf.predict(X_val)\n    print(i, f1_score(list(y_val), list(val_rf), average="weighted"))\n    test_features[i] = rf.predict(test)\n\n\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:08:19.347Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"63f1fcead3e343c89d09617ba98e31f9\",\"cell_num\":42,\"cell_source\":\"new_test_features = ["helper_functions", "load_data", "data_exploration", "data_preprocessing", \n    "evaluation", "modelling", "prediction", "result_visualization", "save_results", "comment_only"]\n\nfor i in new_test_features:\n    y_new = train_features[i]\n    rf = RandomForestClassifier()\n    rf.fit(X, y_new)\n    val_rf = rf.predict(X_val)\n    print(i, f1_score(list(y_val), list(val_rf), average="weighted"))\n    test_features[i] = rf.predict(test)\n\n\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"stream\\",\\"size\\":358}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:09:19.476Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"63f1fcead3e343c89d09617ba98e31f9\",\"cell_num\":41,\"cell_source\":\"new_test_features = ["helper_functions", "load_data", "data_exploration", "data_preprocessing", \n    "evaluation", "modelling", "prediction", "result_visualization", "save_results", "comment_only"]\n\nfor i in new_test_features:\n    y_new = train_features[i]\n    rf = RandomForestClassifier(n_estimators=800, max_depth=8, min_samples_leaf=2, min_samples_split=2)\n    rf.fit(X, y_new)\n    val_rf = rf.predict(X_val)\n    print(i, f1_score(list(y_val), list(val_rf), average="weighted"))\n    test_features[i] = rf.predict(test)\n\n\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:09:54.364Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"63f1fcead3e343c89d09617ba98e31f9\",\"cell_num\":42,\"cell_source\":\"new_test_features = ["helper_functions", "load_data", "data_exploration", "data_preprocessing", \n    "evaluation", "modelling", "prediction", "result_visualization", "save_results", "comment_only"]\n\nfor i in new_test_features:\n    y_new = train_features[i]\n    rf = RandomForestClassifier(n_estimators=800, max_depth=8, min_samples_leaf=2, min_samples_split=2)\n    rf.fit(X, y_new)\n    val_rf = rf.predict(X_val)\n    print(i, f1_score(list(y_val), list(val_rf), average="weighted"))\n    test_features[i] = rf.predict(test)\n\n\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"stream\\",\\"size\\":362}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:16:07.111Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"create\",\"cell_index\":\"106836640c96485885b1b1740c2bc798\",\"cell_num\":37,\"cell_source\":\"\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:16:10.032Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"106836640c96485885b1b1740c2bc798\",\"cell_num\":38,\"cell_source\":\"rf_random.best_params_\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:16:10.117Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"106836640c96485885b1b1740c2bc798\",\"cell_num\":39,\"cell_source\":\"rf_random.best_params_\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"execute_result\\",\\"size\\":178}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:16:25.988Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"create\",\"cell_index\":\"8a5cdea5f25341878e88971adc2ddccc\",\"cell_num\":38,\"cell_source\":\"\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:17:05.074Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"106836640c96485885b1b1740c2bc798\",\"cell_num\":38,\"cell_source\":\"rf_parameters_best = rf_random.best_params_\nprint(rf_random.best_params_)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:17:05.194Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"106836640c96485885b1b1740c2bc798\",\"cell_num\":39,\"cell_source\":\"rf_parameters_best = rf_random.best_params_\nprint(rf_random.best_params_)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"stream\\",\\"size\\":153}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:17:33.002Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"106836640c96485885b1b1740c2bc798\",\"cell_num\":38,\"cell_source\":\"rf_parameters_best = rf_random.best_params_\nprint(rf_random.best_params_)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:17:33.079Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"106836640c96485885b1b1740c2bc798\",\"cell_num\":39,\"cell_source\":\"rf_parameters_best = rf_random.best_params_\nprint(rf_random.best_params_)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"stream\\",\\"size\\":153}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:17:33.863Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"8a5cdea5f25341878e88971adc2ddccc\",\"cell_num\":39,\"cell_source\":\"rf_model_best = RandomForestClassifier(**rf_parameters_best)\n\nrf_model_best.fit(X, y)\n\npred_rf = rf_model_best.predict(test)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:17:36.646Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"execute\",\"cell_index\":\"c4db94ce369741b084baea3d7d98905b\",\"cell_num\":40,\"cell_source\":\"val_rf = rf_model_best.predict(X_val)\n\nf1_score(list(y_val), list(val_rf), average="weighted")\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:17:39.247Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"8a5cdea5f25341878e88971adc2ddccc\",\"cell_num\":41,\"cell_source\":\"rf_model_best = RandomForestClassifier(**rf_parameters_best)\n\nrf_model_best.fit(X, y)\n\npred_rf = rf_model_best.predict(test)\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:17:39.949Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"finished_execute\",\"cell_index\":\"c4db94ce369741b084baea3d7d98905b\",\"cell_num\":41,\"cell_source\":\"val_rf = rf_model_best.predict(X_val)\n\nf1_score(list(y_val), list(val_rf), average="weighted")\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":\"[{\\"output_type\\":\\"execute_result\\",\\"size\\":35}]\"}"[EVENT_SEPARATOR]
"{\"ip_address\":\"172.29.65.156\",\"time\":\"2023-05-06T15:17:44.581Z\",\"kernel_id\":\"e8c4068e-1663-4ccc-83de-8a642678db95\",\"notebook_name\":\"task2.ipynb\",\"event\":\"delete\",\"cell_index\":\"7e6e83b7466749569eee2e09d08376dd\",\"cell_num\":null,\"cell_source\":\"val_rf\",\"cell_type\":\"code\",\"session_id\":\"becd8bd2-a767-4154-a2cd-6e6504578f96\",\"cell_output\":null}"[EVENT_SEPARATOR]
